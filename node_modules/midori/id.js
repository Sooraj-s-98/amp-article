"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _uuid = _interopRequireDefault(require("uuid"));

var _request = _interopRequireDefault(require("./request"));

var _compose = _interopRequireDefault(require("./compose"));

var _apply = _interopRequireDefault(require("./apply"));

var _header = _interopRequireDefault(require("./header"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Attach what is essentially a "transaction id" for being able to correlate
 * the request with other events; it can be referenced by other modules, other
 * logging systems or even the front-end client.
 * @param {Function} fn id -> App
 * @returns {App} App instance.
 */
var _default = fn => (0, _apply.default)(_request.default, _req => {
  // See: http://stackoverflow.com/a/26386900
  const id = _uuid.default.v1();

  return (0, _compose.default)((0, _header.default)('Request-Id', id), fn(id));
});

exports.default = _default;
//# sourceMappingURL=id.js.map
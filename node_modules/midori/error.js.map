{"version":3,"sources":["../src/error.js"],"names":["error","errorHandler","app","requestError","err","req","res","nextApp","request","upgradeError","socket","head","upgrade"],"mappings":";;;;;;;;;;;AAKA,MAAMA,KAAK,GAAIC,YAAD,IAAsCC,GAAD,IAAS;AAC1D,2BACKA,GADL;AAEEC,IAAAA,YAAY,EAAE,OAAOC,GAAP,EAAYC,GAAZ,EAAiBC,GAAjB,KAAyB;AACrC,UAAI;AACF,cAAMC,OAAO,GAAG,MAAMN,YAAY,CAACG,GAAD,CAAlC;AACA,eAAOG,OAAO,CAACL,GAAD,CAAP,CAAaM,OAAb,CAAqBH,GAArB,EAA0BC,GAA1B,CAAP;AACD,OAHD,CAGE,OAAOF,GAAP,EAAY;AACZ,eAAOF,GAAG,CAACC,YAAJ,CAAiBC,GAAjB,EAAsBC,GAAtB,EAA2BC,GAA3B,CAAP;AACD;AACF,KATH;AAUEG,IAAAA,YAAY,EAAE,OAAOL,GAAP,EAAYC,GAAZ,EAAiBK,MAAjB,EAAyBC,IAAzB,KAAkC;AAC9C,UAAI;AACF,cAAMJ,OAAO,GAAG,MAAMN,YAAY,CAACG,GAAD,CAAlC;AACA,eAAOG,OAAO,CAACL,GAAD,CAAP,CAAaU,OAAb,CAAqBP,GAArB,EAA0BK,MAA1B,EAAkCC,IAAlC,CAAP;AACD,OAHD,CAGE,OAAOP,GAAP,EAAY;AACZ,eAAOF,GAAG,CAACO,YAAJ,CAAiBL,GAAjB,EAAsBC,GAAtB,EAA2BK,MAA3B,EAAmCC,IAAnC,CAAP;AACD;AACF;AAjBH;AAmBD,CApBD;;eAsBeX,K","sourcesContent":["// @flow\nimport type {App} from './types';\n\ntype ErrorHandler = (err: Error) => App | Promise<App>;\n\nconst error = (errorHandler: ErrorHandler): App => (app) => {\n  return {\n    ...app,\n    requestError: async (err, req, res) => {\n      try {\n        const nextApp = await errorHandler(err);\n        return nextApp(app).request(req, res);\n      } catch (err) {\n        return app.requestError(err, req, res);\n      }\n    },\n    upgradeError: async (err, req, socket, head) => {\n      try {\n        const nextApp = await errorHandler(err);\n        return nextApp(app).upgrade(req, socket, head);\n      } catch (err) {\n        return app.upgradeError(err, req, socket, head);\n      }\n    },\n  };\n};\n\nexport default error;\n"],"file":"error.js"}
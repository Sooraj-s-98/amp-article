"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _request = _interopRequireDefault(require("./request"));

var _send = _interopRequireDefault(require("./send"));

var _next = _interopRequireDefault(require("./next"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Handle the case when the server is in the process of shutting down. This is
 * useful for upstream proxies that want to know that the server is not ready
 * to handle any more requests.
 * @returns {App} App instance.
 */
var _default = () => (0, _request.default)(req => {
  // TODO: Any way to make flow happy with this?
  // $ExpectError
  if (req.socket._handle === null || req.socket._handle === undefined) {
    return (0, _send.default)(502, {
      Connection: 'close'
    }, '');
  }

  return _next.default;
});

exports.default = _default;
//# sourceMappingURL=graceful.js.map
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _compose = _interopRequireDefault(require("./compose"));

var _next = _interopRequireDefault(require("./next"));

var _response = _interopRequireDefault(require("./response"));

var _request = _interopRequireDefault(require("./request"));

var _match = _interopRequireDefault(require("./match"));

var _protocol = _interopRequireDefault(require("./match/protocol"));

var _redirect = _interopRequireDefault(require("./redirect"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Enable security related functionality.
 * @returns {App} App instance.
 */
var _default = () => (0, _compose.default)( // Ensure app is served over HTTPS.
(0, _match.default)((0, _protocol.default)('https'), _next.default, (0, _request.default)(req => {
  return (0, _redirect.default)(`https://${req.headers.host}${req.url}`);
})), // Send useful security headers for the browser.
(0, _response.default)(res => {
  // https://www.owasp.org/index.php/List_of_useful_HTTP_headers
  res.setHeader('Strict-Transport-Security', 'max-age=16070400');
  res.setHeader('X-Frame-Options', 'deny');
  res.setHeader('X-XSS-Protection', '1; mode=block');
  res.setHeader('X-Download-Options', 'noopen');
  res.setHeader('X-Content-Type-Options', 'nosniff');
  return _next.default;
}));

exports.default = _default;
//# sourceMappingURL=secure.js.map
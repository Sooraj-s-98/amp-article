"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _util = require("./util");

var _default = protocol => (0, _util.create)(req => {
  // TODO: FIXME: Flow seems to think `IncomingMessage` does not have a field
  // called `connection`.
  // $ExpectError
  let proto = req.connection.encrypted ? 'https' : 'http'; // TODO: Ensure header is from trusted proxy!!.

  proto = req.headers['x-forwarded-proto'] || proto;
  proto = proto.split(/\s*,\s*/)[0];
  return proto === `${protocol}`.replace(/:$/, '');
});

exports.default = _default;
//# sourceMappingURL=protocol.js.map
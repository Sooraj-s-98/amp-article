{"version":3,"sources":["../src/secure.js"],"names":["next","req","headers","host","url","res","setHeader"],"mappings":";;;;;;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAIA;;;;eAIe,MACb,uBACE;AACA,oBACE,uBAAS,OAAT,CADF,EAEEA,aAFF,EAGE,sBAASC,GAAD,IAAS;AACf,SAAO,uBAAU,WAAUA,GAAG,CAACC,OAAJ,CAAYC,IAAK,GAAEF,GAAG,CAACG,GAAI,EAA/C,CAAP;AACD,CAFD,CAHF,CAFF,EASE;AACA,uBAAUC,GAAD,IAAS;AAChB;AACAA,EAAAA,GAAG,CAACC,SAAJ,CAAc,2BAAd,EAA2C,kBAA3C;AACAD,EAAAA,GAAG,CAACC,SAAJ,CAAc,iBAAd,EAAiC,MAAjC;AACAD,EAAAA,GAAG,CAACC,SAAJ,CAAc,kBAAd,EAAkC,eAAlC;AACAD,EAAAA,GAAG,CAACC,SAAJ,CAAc,oBAAd,EAAoC,QAApC;AACAD,EAAAA,GAAG,CAACC,SAAJ,CAAc,wBAAd,EAAwC,SAAxC;AACA,SAAON,aAAP;AACD,CARD,CAVF,C","sourcesContent":["// @flow\nimport compose from './compose';\nimport next from './next';\nimport response from './response';\nimport request from './request';\nimport match from './match';\nimport protocol from './match/protocol';\nimport redirect from './redirect';\n\nimport type {App} from './types';\n\n/**\n * Enable security related functionality.\n * @returns {App} App instance.\n */\nexport default (): App =>\n  compose(\n    // Ensure app is served over HTTPS.\n    match(\n      protocol('https'),\n      next,\n      request((req) => {\n        return redirect(`https://${req.headers.host}${req.url}`);\n      }),\n    ),\n    // Send useful security headers for the browser.\n    response((res) => {\n      // https://www.owasp.org/index.php/List_of_useful_HTTP_headers\n      res.setHeader('Strict-Transport-Security', 'max-age=16070400');\n      res.setHeader('X-Frame-Options', 'deny');\n      res.setHeader('X-XSS-Protection', '1; mode=block');\n      res.setHeader('X-Download-Options', 'noopen');\n      res.setHeader('X-Content-Type-Options', 'nosniff');\n      return next;\n    }),\n  );\n"],"file":"secure.js"}